for (i in 1:iter){
data1<-data%>%select(1:(p+1))%>%group_by(group)%>%nest()%>%mutate(cent=map(data,colMeans))%>%arrange(group)
cent_dist= matrix(0,K,n)
for (j in 1:K){
center<-data1$cent[j]%>%unlist
cent_dist[j,]<-(data%>%select(1:p)-center)^2%>%rowMeans
}
for (m in 1:n){
data$group[m]<-cent_dist[,1]%>%which.min()
}
}
i<-1
data1<-data%>%select(1:(p+1))%>%group_by(group)%>%nest()%>%mutate(cent=map(data,colMeans))%>%arrange(group)
cent_dist= matrix(0,K,n)
for (j in 1:K){
center<-data1$cent[j]%>%unlist
cent_dist[j,]<-(data%>%select(1:p)-center)^2%>%rowMeans
}
for (m in 1:n){
data$group[m]<-cent_dist[,1]%>%which.min()
}
data1
cent_dist= matrix(0,K,n)
for (j in 1:K){
center<-data1$cent[j]%>%unlist
cent_dist[j,]<-(data%>%select(1:p)-center)^2%>%rowMeans
}
j=1
center<-data1$cent[j]%>%unlist
center
cent_dist[j,]
cent_dist[j,]<-(data%>%select(1:p)-center)^2%>%rowMeans
j=2
center<-data1$cent[j]%>%unlist
cent_dist[j,]<-(data%>%select(1:p)-center)^2%>%rowMeans
(data%>%select(1:p)-center)^2%>%rowMeans
(data%>%select(1:p)-center)^2
data%>%select(1:p)
center
data1$cent[j]%>%unlist
data1$cent
data1
k
K
data
sample(1:K,n,T)
data
P5ClusterData%>%head(50)%>%select(1:10)->data
data<-as_tibble(data)
p = ncol(data)
iter= 10
n<-nrow(data)
group<-sample(1:K,n,T)
group
group<-sample(1:K,n,T)
data<-cbind(data,group=group)
data
P5ClusterData%>%head(50)%>%select(1:10)->data
data
data<-as_tibble(data)
p = ncol(data)
iter= 10
n<-nrow(data)
group<-sample(1:K,n,T)
data<-cbind(data,group=group)
for (i in 1:1){
data1<-data%>%select(1:(p+1))%>%group_by(group)%>%nest()%>%mutate(cent=map(data,colMeans))%>%arrange(group)
cent_dist= matrix(0,K,n)
for (j in 1:K){
center<-data1$cent[j]%>%unlist
cent_dist[j,]<-(data%>%select(1:p)-center)^2%>%rowMeans
}
for (m in 1:n){
data$group[m]<-cent_dist[,1]%>%which.min()
}
}
data
P5ClusterData%>%head(50)%>%select(1:10)->data
P5ClusterData%>%head(10)%>%select(1:7)->data
data
P5ClusterData%>%head(10)%>%select(1:7)->data
data
data<-as_tibble(data)
p = ncol(data)
iter= 10
n<-nrow(data)
group<-sample(1:K,n,T)
group
K=5
data<-as_tibble(data)
p = ncol(data)
iter= 10
n<-nrow(data)
group<-sample(1:K,n,T)
data<-cbind(data,group=group)
data
sample(1:K,n,T)
sample(1:K,n,T)
sample(1:K,n,T)
sample(1:K,n,T)
sample(1:K,n,T)
sample(1:K,n,T)
sample(1:K,n,T)
for (i in 1:1){
data1<-data%>%select(1:(p+1))%>%group_by(group)%>%nest()%>%mutate(cent=map(data,colMeans))%>%arrange(group)
cent_dist= matrix(0,K,n)
for (j in 1:K){
center<-data1$cent[j]%>%unlist
cent_dist[j,]<-(data%>%select(1:p)-center)^2%>%rowMeans
}
for (m in 1:n){
data$group[m]<-cent_dist[,1]%>%which.min()
}
}
data
cent_dist
data<-as_tibble(data)
p = ncol(data)
iter= 10
n<-nrow(data)
group<-sample(1:K,n,T)
data<-cbind(data,group=group)
for (i in 1:1){
data1<-data%>%select(1:(p+1))%>%group_by(group)%>%nest()%>%mutate(cent=map(data,colMeans))%>%arrange(group)
cent_dist= matrix(0,K,n)
for (j in 1:K){
center<-data1$cent[j]%>%unlist
cent_dist[j,]<-(data%>%select(1:p)-center)^2%>%rowMeans
}
for (m in 1:n){
data$group[m]<-cent_dist[,m]%>%which.min()
}
}
P5ClusterData%>%head(10)%>%select(1:7)->data
data<-as_tibble(data)
p = ncol(data)
iter= 10
n<-nrow(data)
group<-sample(1:K,n,T)
data<-cbind(data,group=group)
for (i in 1:1){
data1<-data%>%select(1:(p+1))%>%group_by(group)%>%nest()%>%mutate(cent=map(data,colMeans))%>%arrange(group)
cent_dist= matrix(0,K,n)
for (j in 1:K){
center<-data1$cent[j]%>%unlist
cent_dist[j,]<-(data%>%select(1:p)-center)^2%>%rowMeans
}
for (m in 1:n){
data$group[m]<-cent_dist[,m]%>%which.min()
}
}
data
for (i in 1:1){
data1<-data%>%select(1:(p+1))%>%group_by(group)%>%nest()%>%mutate(cent=map(data,colMeans))%>%arrange(group)
cent_dist= matrix(0,K,n)
for (j in 1:K){
center<-data1$cent[j]%>%unlist
cent_dist[j,]<-(data%>%select(1:p)-center)^2%>%rowMeans
}
for (m in 1:n){
data$group[m]<-cent_dist[,m]%>%which.min()
}
}
data1<-data%>%select(1:(p+1))%>%group_by(group)%>%nest()%>%mutate(cent=map(data,colMeans))%>%arrange(group)
data1
data1$cent[1]
data1$cent[2]
data1$cent[3]
data1<-data%>%select(1:(p+1))%>%group_by(group)%>%nest()%>%mutate(cent=map(data,colMeans))%>%arrange(group)
cent_dist= matrix(0,K,n)
j=1
center<-data1$cent[j]%>%unlist
cent_dist[j,]<-(data%>%select(1:p)-center)^2%>%rowMeans
cent_dist= matrix(0,K,n)
for (j in 1:K){
center<-data1$cent[j]%>%unlist
cent_dist[j,]<-(data%>%select(1:p)-center)^2%>%rowMeans
}
j=1
cent_dist= matrix(0,K,n)
center<-data1$cent[j]%>%unlist
cent_dist[j,]<-(data%>%select(1:p)-center)^2%>%rowMeans
j=2
center<-data1$cent[j]%>%unlist
center
cent_dist[j,]<-(data%>%select(1:p)-center)^2%>%rowMeans
j=3
center<-data1$cent[j]%>%unlist
cent_dist
center
j=4
center<-data1$cent[j]%>%unlist
cent_dist[j,]<-(data%>%select(1:p)-center)^2%>%rowMeans
j=5
e
center<-data1$cent[j]%>%unlist
cent_dist[j,]<-(data%>%select(1:p)-center)^2%>%rowMeans
center
data1
P5ClusterData%>%head(10)%>%select(1:7)->data
data<-as_tibble(data)
p = ncol(data)
iter= 10
n<-nrow(data)
group<-sample(1:K,n,T)
data<-cbind(data,group=group)
for (i in 1:1){
data1<-data%>%select(1:(p+1))%>%group_by(group)%>%nest()%>%mutate(cent=map(data,colMeans))%>%arrange(group)
group_new<-data1$group%>%unique()
cent_dist= matrix(0,K,n)
for (j in 1:seq_along(group_new)){
center<-data1$cent[j]%>%unlist
cent_dist[j,]<-(data%>%select(1:p)-center)^2%>%rowMeans
}
for (m in 1:n){
data$group[m]<-cent_dist[,m]%>%which.min()
}
}
data<-as_tibble(data)
p = ncol(data)
iter= 10
n<-nrow(data)
group<-sample(1:K,n,T)
data<-cbind(data,group=group)
for (i in 1:1){
data1<-data%>%select(1:(p+1))%>%group_by(group)%>%nest()%>%mutate(cent=map(data,colMeans))%>%arrange(group)
group_new<-data1$group%>%unique()
cent_dist= matrix(0,K,n)
for (j in 1:seq_along(group_new)){
center<-data1$cent[j]%>%unlist
cent_dist[j,]<-(data%>%select(1:p)-center)^2%>%rowMeans
}
for (m in 1:n){
data$group[m]<-cent_dist[,m]%>%which.min()
}
}
P5ClusterData%>%head(10)%>%select(1:7)->data
data<-as_tibble(data)
p = ncol(data)
iter= 10
n<-nrow(data)
group<-sample(1:K,n,T)
data<-cbind(data,group=group)
data
for (i in 1:1){
data1<-data%>%select(1:(p+1))%>%group_by(group)%>%nest()%>%mutate(cent=map(data,colMeans))%>%arrange(group)
group_new<-data1$group%>%unique()
cent_dist= matrix(0,K,n)
for (j in 1:seq_along(group_new)){
center<-data1$cent[j]%>%unlist
cent_dist[j,]<-(data%>%select(1:p)-center)^2%>%rowMeans
}
for (m in 1:n){
data$group[m]<-cent_dist[,m]%>%which.min()
}
}
for (i in 1:1){
data1<-data%>%select(1:(p+1))%>%group_by(group)%>%nest()%>%mutate(cent=map(data,colMeans))%>%arrange(group)
group_new<-data1$group%>%unique()
cent_dist= matrix(0,K,n)
for (j in 1:seq_along(group_new)){
center<-data1$cent[j]%>%unlist
cent_dist[j,]<-(data%>%select(1:p)-center)^2%>%rowMeans
}
for (m in 1:n){
data$group[m]<-cent_dist[,m]%>%which.min()
}
}
for (i in 1:1){
data1<-data%>%select(1:(p+1))%>%group_by(group)%>%nest()%>%mutate(cent=map(data,colMeans))%>%arrange(group)
group_new<-data1$group%>%unique()
cent_dist= matrix(0,K,n)
for (j in 1:seq_along(group_new)){
center<-data1$cent[j]%>%unlist
cent_dist[j,]<-(data%>%select(1:p)-center)^2%>%rowMeans
}
for (m in 1:n){
data$group[m]<-cent_dist[,m]%>%which.min()
}
}
k_mean<-function(data,K){
data<-as_tibble(data)
p = ncol(data)
iter= 10
n<-nrow(data)
group<-sample(1:K,n,T)
data<-cbind(data,group=group)
for (i in 1:1){
data1<-data%>%select(1:(p+1))%>%group_by(group)%>%nest()%>%mutate(cent=map(data,colMeans))%>%arrange(group)
group_new<-data1$group%>%unique()
cent_dist= matrix(0,K,n)
for (j in 1:seq_along(group_new)){
center<-data1$cent[j]%>%unlist
cent_dist[j,]<-(data%>%select(1:p)-center)^2%>%rowMeans
}
for (m in 1:n){
data$group[m]<-cent_dist[,m]%>%which.min()
}
}
}
data
for (i in 1:1){
data1<-data%>%select(1:(p+1))%>%group_by(group)%>%nest()%>%mutate(cent=map(data,colMeans))%>%arrange(group)
group_new<-data1$group%>%unique()
cent_dist= matrix(0,K,n)
for (j in 1:seq_along(group_new)){
center<-data1$cent[j]%>%unlist
cent_dist[j,]<-(data%>%select(1:p)-center)^2%>%rowMeans
}
for (m in 1:n){
data$group[m]<-cent_dist[,m]%>%which.min()
}
}
group_new =rep(0,n)
group_new=group
group
group_new
group_new=group
group_new =rep(0,n)
group_new
group_new==group
group_new!=group
(group_new!=group)%>%sum()
(group_new!=group)%>%sum()==0
P5ClusterData%>%head(10)%>%select(1:7)->data
k_mean<-function(data,K){
data<-as_tibble(data)
p = ncol(data)
iter= 10
n<-nrow(data)
group<-sample(1:K,n,T)
data<-cbind(data,group=group)
group_new =rep(0,n)
if ((group_new!=data$group)%>%sum()==0){
for (i in 1:iter){
data1<-data%>%select(1:(p+1))%>%group_by(group)%>%nest()%>%mutate(cent=map(data,colMeans))%>%arrange(group)
group_new<-data1$group%>%unique()
cent_dist= matrix(0,K,n)
for (j in 1:seq_along(group_new)){
center<-data1$cent[j]%>%unlist
cent_dist[j,]<-(data%>%select(1:p)-center)^2%>%rowMeans
}
for (m in 1:n){
data$group[m]<-cent_dist[,m]%>%which.min()
}
}}
}
k_mean(data,3)
k_mean<-function(data,K){
data<-as_tibble(data)
p = ncol(data)
iter= 10
n<-nrow(data)
group<-sample(1:K,n,T)
data<-cbind(data,group=group)
group_new =rep(0,n)
if ((group_new!=data$group)%>%sum()==0){
for (i in 1:iter){
data1<-data%>%select(1:(p+1))%>%group_by(group)%>%nest()%>%mutate(cent=map(data,colMeans))%>%arrange(group)
group_new<-data1$group%>%unique()
cent_dist= matrix(0,K,n)
for (j in 1:seq_along(group_new)){
center<-data1$cent[j]%>%unlist
cent_dist[j,]<-(data%>%select(1:p)-center)^2%>%rowMeans
}
for (m in 1:n){
data$group[m]<-cent_dist[,m]%>%which.min()
}
}}
return(data)
}
k_mean(data,3)
k_mean(data,4)
k_mean(data,2)
k_mean<-function(data,K){
data<-as_tibble(data)
p = ncol(data)
iter= 10
n<-nrow(data)
group<-sample(1:K,n,T)
data<-cbind(data,group=group)
group_new =rep(0,n)
if ((group_new!=data$group)%>%sum()!=0){
for (i in 1:iter){
data1<-data%>%select(1:(p+1))%>%group_by(group)%>%nest()%>%mutate(cent=map(data,colMeans))%>%arrange(group)
group_new<-data1$group%>%unique()
cent_dist= matrix(0,K,n)
for (j in 1:seq_along(group_new)){
center<-data1$cent[j]%>%unlist
cent_dist[j,]<-(data%>%select(1:p)-center)^2%>%rowMeans
}
for (m in 1:n){
data$group[m]<-cent_dist[,m]%>%which.min()
}
}}
return(data)
}
k_mean(data,3)
k_mean(data,4)
k_mean(data,2)
k_mean(data,1)
k_mean(P5ClusterData,3)%>%head(50)
k_mean(P5ClusterData,3)%>%select(group)%>%head(50)
k_mean(P5ClusterData,3)%>%select(group)%>%unique()
k_mean(P5ClusterData,5)%>%select(group)%>%unique()
P5ClusterData%>%head(100)%>%select(1:20)->data
data<-as_tibble(data)
p = ncol(data)
iter= 10
n<-nrow(data)
group<-sample(1:K,n,T)
data<-cbind(data,group=group)
group_new =rep(0,n)
(group_new!=data$group)%>%sum()!=0
{
data1<-data%>%select(1:(p+1))%>%group_by(group)%>%nest()%>%mutate(cent=map(data,colMeans))%>%arrange(group)
group_new<-data1$group%>%unique()
cent_dist= matrix(0,K,n)
for (j in 1:seq_along(group_new)){
center<-data1$cent[j]%>%unlist
cent_dist[j,]<-(data%>%select(1:p)-center)^2%>%rowMeans
}
for (m in 1:n){
data$group[m]<-cent_dist[,m]%>%which.min()
}
}
data$group
P5ClusterData%>%sample_frac(0.1)%>%select(1:20)->data
data<-as_tibble(data)
p = ncol(data)
iter= 10
n<-nrow(data)
group<-sample(1:K,n,T)
data<-cbind(data,group=group)
group_new =rep(0,n)
(group_new!=data$group)%>%sum()!=0
install.packages("shinydashboard")
library(tidyverse)
install.packages("tidyverse")
library(tidyverse)
?pivot_longer
shiny::runApp('GitHub/Spring2020-Project2-group-8/app')
runApp('GitHub/Spring2020-Project2-group-8/app')
shiny::runApp()
shiny::runApp()
runApp()
runApp()
shiny::runApp()
###function
bar<-function(type){
type_content<-subset_nutrition%>% select(restaurant,Food_Category,type)%>% group_by(Food_Category)%>%summarise(ttype = mean(type))
bar<-plot_ly(
x = type_content$ttype,
y = type_content$Food_Category,
marker = list(color = new_col),
type = "bar"
return(bar)
)
}
runApp()
runApp()
runApp()
bar("Suger")
###function
bar<-function(type){
type_content<-subset_nutrition%>% select(restaurant,Food_Category,type)%>% group_by(Food_Category)%>%summarise(ttype = mean(type))
bar<-plot_ly(
x = type_content$ttype,
y = type_content$Food_Category,
marker = list(color = new_col),
type = "bar")
return(bar)
}
bar("Suger")
subset_nutrition <-menu_clean %>%select(restaurant,menu)%>%unnest(menu)%>%
select(restaurant,Item_Name,Item_Description,Food_Category,Calories:Dietary_Fiber,Shareable)%>%
filter(Shareable==0)%>%select(-Potassium,-Shareable)%>%group_by(restaurant)%>%arrange(restaurant)%>%nest()%>%ungroup%>%mutate(restaurant_id=row_number())%>%group_by(restaurant)%>%unnest()%>%mutate(menu_id=row_number())%>%
select(restaurant_id,restaurant,menu_id,Item_Name,Item_Description,Food_Category,everything())
#colname<-subset_nutrition%>%colnames()
#nutrition<-colname[9:18]
#food_category<-subset_nutrition$Food_Category%>%unique()
### Replacing some NA values:
subset_nutrition$Calories[which(is.na(subset_nutrition$Calories))] = 0
subset_nutrition$Total_Fat[which(is.na(subset_nutrition$Total_Fat))] = 0
subset_nutrition$Saturated_Fat[which(is.na(subset_nutrition$Saturated_Fat))] = 0
subset_nutrition$Trans_Fat[which(is.na(subset_nutrition$Trans_Fat))] = 0
subset_nutrition$Cholesterol[which(is.na(subset_nutrition$Cholesterol))] = 0
subset_nutrition$Sodium[which(is.na(subset_nutrition$Sodium))] = 0
subset_nutrition$Carbohydrates[which(is.na(subset_nutrition$Carbohydrates))] = 0
subset_nutrition$Protein[which(is.na(subset_nutrition$Protein))] = 0
subset_nutrition$Sugar[which(is.na(subset_nutrition$Sugar))] = 0
subset_nutrition$Dietary_Fiber[which(is.na(subset_nutrition$Dietary_Fiber))] = 0
subset_nutrition
bar("Suger")
bar("Sugers")
bar("Sugar")
new_col<-c("grey50", "blue","hotpink","Magenta","orange", "red","seagreen","violet","brown","maroon","navyblue", "yellow")
bar("Sugar")
type="Sugar"
type_content<-subset_nutrition%>% select(restaurant,Food_Category,type)%>% group_by(Food_Category)%>%summarise(ttype = mean(type))
bar<-plot_ly(
x = type_content$ttype,
y = type_content$Food_Category,
marker = list(color = new_col),
type = "bar")
bar
runApp()
subset_nutrition
names(subset_nutrition)
runApp()
runApp()
runApp()
